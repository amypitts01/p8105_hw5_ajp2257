---
title: "p8105_hw5_ajp2257"
author: "Amy Pitts"
date: "11/8/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

# Problem 2
This zip file contains data from a longitudinal study that included a control arm and an experimental arm. Data for each participant is included in a separate file, and file names include the subject ID and arm.

Create a tidy dataframe containing data from all participants, including the subject ID, arm, and observations over time:

Start with a dataframe containing all file names; the list.files function will help
Iterate over file names and read in data for each subject using purrr::map and saving the result as a new variable in the dataframe
Tidy the result; manipulate file names to include control arm and subject ID, make sure weekly observations are “tidy”, and do any other tidying that’s necessary
Make a spaghetti plot showing observations on each subject over time, and comment on differences between groups.

```{r}
files = list.files("data", pattern = "*.csv") # get the file name 
data  = files %>% # reading the data from each file 
  map(~ read_csv(file.path("data", .)))  %>%  # read in all the files
  reduce(rbind) # getting the results from the files 

# getting the arm and the id from the file names 
participant = separate(data.frame(files), col=files, sep = "([._])", into =c("arm", "id")) 

# to be able to plot the data we need a values columns and a time column 
participants_df = tibble(participant, data ) %>% # combining the data and the arm and id 
  pivot_longer( # we are pivoting all the variables 
    cols = week_1:week_8,
    names_prefix = "week_",
    names_to = "week",
    values_to = "value"
  )
head(participants_df) # quick view of the data 
```

Plotting time! 

```{r}
# looking at spagetti plot over time (in weeks) by the two different arms 
ggplot(data = participants_df, aes(x = week, y = value, group = id)) + 
  geom_line(aes(color=id)) + # coloring the participants id 
  facet_grid(. ~ arm) + # splitting the graph by arm
  labs(
    title = "A Spaghetti plot showing each participant over time (weeks) by group."
  )
```

In looks like in the control group the values seem to stay on the lower side never going above about 4. The experiment group starts with values on the lower side just like the control group but then the values increase over time. In the later weeks it looks like the control group and the experiment group are different with the experiment group having bigger values. 








